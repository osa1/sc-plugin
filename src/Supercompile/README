Initially copied from ghc/supercompile branch.
